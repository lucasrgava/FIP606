{"title":"Aula 11","markdown":{"yaml":{"title":"Aula 11","format":"html","editor":"visual"},"headingText":"Construção de mapas","containsRefs":false,"markdown":"\n\n\nUtilizando o pacote ggplot2 e o pacote leaflet.\n\nSeguiremos, a partir de agora, com foco na criação de mapas utilizando o **RStudio**.\n\n## Instação de pacotes\n\nInstalando os pacotes **rnaturalearthhires** e **rnaturalearth**.\n\n```{r}\n# remotes::install_github(\"ropensci/rnaturalearthhires\")\n# install.packages('rnaturalearthhires', repos = 'http://packages.ropensci.org', type = \"source\")\n# install.packages('rnaturalearth')\n```\n\n# Pacotes\n\nPacotes que serão utilizados no decorrer dos códigos.\n\n```{r message=FALSE, warning=FALSE}\nlibrary(gsheet) # para importação de dados da web\nlibrary(tidyverse) # para manipulação de dados\nlibrary(rnaturalearthhires) # para criação de mapas\nlibrary(rnaturalearth) # para criação de mapas\nlibrary(ggthemes) # mais temas gráficos\nlibrary(ggspatial) # inserir rosa dos ventos\nlibrary(plotly) # para gráfico interativo\nlibrary(leaflet) # mapa igual ao google maps\nlibrary(r4pde) # para acessar o banco de dados\nlibrary(scatterpie) # criar os gráficos de pizzas em cada ponto\nlibrary(ggrepel) # colocar nome em cima do ponto\n```\n\n# Banco de dados\n\nO banco de dados a seguir, é referente a locais de ocorrência de epidemias de ferrugem da soja.\n\nUtilizando o código abaixo, é possível selecionar os limites de região de interesse, seja estado, país, entre outros. No nosso caso, selecionamos os limites dos estados do Brasil, que coincidem os pontos do nosso banco de dados. Sobrepondo essas camadas, de pontos e limites estaduais, podemos ver as ocorrências no Brasil.\n\n```{r}\nBRA <- ne_states(country = \"Brazil\", returnclass = \"sf\")\nMG <- BRA |> \n  filter(name_en == 'Minas Gerais')\n\nsbr <- RustSoybean # banco de dados do pacote r4pde\n\nsbr |> \n  ggplot(aes(longitude, latitude))+\n  geom_point()+\n  coord_sf()\n\nbra <- ggplot(BRA) +\n  geom_sf(fill = 'lightgray', color = 'darkgray', linewidth = 0.5)+\n  geom_sf(data = MG, fill = 'darkgray') +\n  geom_point(data = sbr, aes(longitude, latitude),\n             color = 'darkgreen', alpha = 0.7, size = 2) +\n  theme_map() +\n  annotation_north_arrow(which_north = 'grid')\n\nbra\n\n\n```\n\nA função `ggplotly()` do pacote **plotly** permite tornar os gráficos gerados no **ggplot2** dinâmicos e interativos, veja:\n\n```{r}\nggplotly(bra) ## criando gráfico interativo\n```\n\n## Mapas iguais ao do Google maps!\n\nCriando um gráfico interativo igual ao google maps e inserindo pontos. A função `leaflet()` identifica automaticamente dentro do banco de tados **sbr** as colunas nomeadas com **latitude** e **longitude** não precisando identificar quais são. A função **addCircleMarkers()** insere os pontos de acordo com as coordenadas. O grafico gerado também é interativo.\n\n```{r}\nleaflet(sbr) |> \n  addTiles() |> \n  #setView(lng = -42.8825, lat = -20.7546, zoom = 5) |> \n  addCircleMarkers(radius = 1)\n```\n\nTestando outras camadas:\n\n```{r}\nleaflet() |> \n  addProviderTiles(providers$Esri.NatGeoWorldMap) |> \n  setView(lng = -42.8825, lat = -20.7546, zoom = 5)\n```\n\n## Outro mapa\n\nMapa do Brasil com distribuição das doenças e presença de cada uma na forma de gráfico de pizza. Os gráficos de pizzas não representam de forma proporcional as ocorrências das doenças, mas sim, a presença.\n\n```{r, warning=FALSE}\n\nmapa <- gsheet2tbl('https://docs.google.com/spreadsheets/d/1pAIFKsdKxk_UQQXdYwIO-O5NOkYNhpclImJcLziYnk4/edit?usp=sharing ')\n\n\nBra_2 <- ggplot(BRA) +\n  geom_sf(fill = \"white\", color = \"black\", linewidth = 0.5) +\n  coord_sf()+\n  geom_scatterpie(aes(x = lon, y = lat, r = 0.6),\n                  alpha = 0.8, color = NA, data = mapa,\n                  cols = c (\"DFC\",\n                            \"MA\",\n                            \"FER\",\n                            \"ANTR\",\n                            \"OIDIO\"))+\n  geom_text_repel(data = mapa, aes(lon, lat, label = Local),\n                  size = 2, nudge_x = 0.2, nudge_y = 0.27, color = 'gray30', family = \"Arial\")+\n  ggthemes::scale_fill_calc()+\n  ggthemes::theme_map()+\n  labs(x = \"Longitude\", y = \"Laititude\", legend = \" \", fill = \"Doença\")+\n  theme(legend.position = \"bottom\", text = element_text(family = \"Arieal\", size = 8))\n\nBra_2\n```\n\nAs possibilidades de criação de mapas, utilizando o **RStudio,** são muitas. Basta uma boa criatividade para utilização dos recursos e mãos a obra!\n","srcMarkdownNoYaml":"\n\n# Construção de mapas\n\nUtilizando o pacote ggplot2 e o pacote leaflet.\n\nSeguiremos, a partir de agora, com foco na criação de mapas utilizando o **RStudio**.\n\n## Instação de pacotes\n\nInstalando os pacotes **rnaturalearthhires** e **rnaturalearth**.\n\n```{r}\n# remotes::install_github(\"ropensci/rnaturalearthhires\")\n# install.packages('rnaturalearthhires', repos = 'http://packages.ropensci.org', type = \"source\")\n# install.packages('rnaturalearth')\n```\n\n# Pacotes\n\nPacotes que serão utilizados no decorrer dos códigos.\n\n```{r message=FALSE, warning=FALSE}\nlibrary(gsheet) # para importação de dados da web\nlibrary(tidyverse) # para manipulação de dados\nlibrary(rnaturalearthhires) # para criação de mapas\nlibrary(rnaturalearth) # para criação de mapas\nlibrary(ggthemes) # mais temas gráficos\nlibrary(ggspatial) # inserir rosa dos ventos\nlibrary(plotly) # para gráfico interativo\nlibrary(leaflet) # mapa igual ao google maps\nlibrary(r4pde) # para acessar o banco de dados\nlibrary(scatterpie) # criar os gráficos de pizzas em cada ponto\nlibrary(ggrepel) # colocar nome em cima do ponto\n```\n\n# Banco de dados\n\nO banco de dados a seguir, é referente a locais de ocorrência de epidemias de ferrugem da soja.\n\nUtilizando o código abaixo, é possível selecionar os limites de região de interesse, seja estado, país, entre outros. No nosso caso, selecionamos os limites dos estados do Brasil, que coincidem os pontos do nosso banco de dados. Sobrepondo essas camadas, de pontos e limites estaduais, podemos ver as ocorrências no Brasil.\n\n```{r}\nBRA <- ne_states(country = \"Brazil\", returnclass = \"sf\")\nMG <- BRA |> \n  filter(name_en == 'Minas Gerais')\n\nsbr <- RustSoybean # banco de dados do pacote r4pde\n\nsbr |> \n  ggplot(aes(longitude, latitude))+\n  geom_point()+\n  coord_sf()\n\nbra <- ggplot(BRA) +\n  geom_sf(fill = 'lightgray', color = 'darkgray', linewidth = 0.5)+\n  geom_sf(data = MG, fill = 'darkgray') +\n  geom_point(data = sbr, aes(longitude, latitude),\n             color = 'darkgreen', alpha = 0.7, size = 2) +\n  theme_map() +\n  annotation_north_arrow(which_north = 'grid')\n\nbra\n\n\n```\n\nA função `ggplotly()` do pacote **plotly** permite tornar os gráficos gerados no **ggplot2** dinâmicos e interativos, veja:\n\n```{r}\nggplotly(bra) ## criando gráfico interativo\n```\n\n## Mapas iguais ao do Google maps!\n\nCriando um gráfico interativo igual ao google maps e inserindo pontos. A função `leaflet()` identifica automaticamente dentro do banco de tados **sbr** as colunas nomeadas com **latitude** e **longitude** não precisando identificar quais são. A função **addCircleMarkers()** insere os pontos de acordo com as coordenadas. O grafico gerado também é interativo.\n\n```{r}\nleaflet(sbr) |> \n  addTiles() |> \n  #setView(lng = -42.8825, lat = -20.7546, zoom = 5) |> \n  addCircleMarkers(radius = 1)\n```\n\nTestando outras camadas:\n\n```{r}\nleaflet() |> \n  addProviderTiles(providers$Esri.NatGeoWorldMap) |> \n  setView(lng = -42.8825, lat = -20.7546, zoom = 5)\n```\n\n## Outro mapa\n\nMapa do Brasil com distribuição das doenças e presença de cada uma na forma de gráfico de pizza. Os gráficos de pizzas não representam de forma proporcional as ocorrências das doenças, mas sim, a presença.\n\n```{r, warning=FALSE}\n\nmapa <- gsheet2tbl('https://docs.google.com/spreadsheets/d/1pAIFKsdKxk_UQQXdYwIO-O5NOkYNhpclImJcLziYnk4/edit?usp=sharing ')\n\n\nBra_2 <- ggplot(BRA) +\n  geom_sf(fill = \"white\", color = \"black\", linewidth = 0.5) +\n  coord_sf()+\n  geom_scatterpie(aes(x = lon, y = lat, r = 0.6),\n                  alpha = 0.8, color = NA, data = mapa,\n                  cols = c (\"DFC\",\n                            \"MA\",\n                            \"FER\",\n                            \"ANTR\",\n                            \"OIDIO\"))+\n  geom_text_repel(data = mapa, aes(lon, lat, label = Local),\n                  size = 2, nudge_x = 0.2, nudge_y = 0.27, color = 'gray30', family = \"Arial\")+\n  ggthemes::scale_fill_calc()+\n  ggthemes::theme_map()+\n  labs(x = \"Longitude\", y = \"Laititude\", legend = \" \", fill = \"Doença\")+\n  theme(legend.position = \"bottom\", text = element_text(family = \"Arieal\", size = 8))\n\nBra_2\n```\n\nAs possibilidades de criação de mapas, utilizando o **RStudio,** são muitas. Basta uma boa criatividade para utilização dos recursos e mãos a obra!\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"Aula_11.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.555","editor":"visual","theme":{"light":"flatly","dark":"darkly"},"title":"Aula 11"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}